<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.92.2">
<meta name=robots content="index, follow">
<link rel="shortcut icon" href=/observability-workshop/v4.7/favicons/favicon.ico>
<link rel=apple-touch-icon href=/observability-workshop/v4.7/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/observability-workshop/v4.7/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/observability-workshop/v4.7/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/observability-workshop/v4.7/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/observability-workshop/v4.7/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/observability-workshop/v4.7/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/observability-workshop/v4.7/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/observability-workshop/v4.7/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/observability-workshop/v4.7/favicons/android-192x192.png sizes=192x192>
<title>Deploying the OpenTelemetry Collector in Kubernetes | Splunk Observability Cloud Workshops</title>
<meta name=description content="
Use the Splunk Helm chart to install the OpenTelemetry Collector in K3s
Explore your cluster in the Kubernetes Navigator


1. Obtain Access Token
You …">
<meta property="og:title" content="Deploying the OpenTelemetry Collector in Kubernetes">
<meta property="og:description" content="Use the Splunk Helm chart to install the OpenTelemetry Collector in K3s Explore your cluster in the Kubernetes Navigator   1. Obtain Access Token You will need to obtain your Access Token1 from the Splunk UI. You can find the workshop Access Token by clicking &#187; bottom left and then selecting Settings → Access Tokens.
Expand the workshop token that your host has instructed you to use e.g. O11y-Workshop-ACCESS, then click on Show Token to expose your token.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://signalfx.github.io/observability-workshop/v4.7/imt/docs/gdi/k3s/"><meta property="article:section" content="imt">
<meta property="article:modified_time" content="2022-03-10T16:28:43+00:00"><meta property="og:site_name" content="Splunk Observability Cloud Workshops">
<meta itemprop=name content="Deploying the OpenTelemetry Collector in Kubernetes">
<meta itemprop=description content="Use the Splunk Helm chart to install the OpenTelemetry Collector in K3s Explore your cluster in the Kubernetes Navigator   1. Obtain Access Token You will need to obtain your Access Token1 from the Splunk UI. You can find the workshop Access Token by clicking &#187; bottom left and then selecting Settings → Access Tokens.
Expand the workshop token that your host has instructed you to use e.g. O11y-Workshop-ACCESS, then click on Show Token to expose your token.">
<meta itemprop=dateModified content="2022-03-10T16:28:43+00:00">
<meta itemprop=wordCount content="962">
<meta itemprop=keywords content="k3s,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Deploying the OpenTelemetry Collector in Kubernetes">
<meta name=twitter:description content="Use the Splunk Helm chart to install the OpenTelemetry Collector in K3s Explore your cluster in the Kubernetes Navigator   1. Obtain Access Token You will need to obtain your Access Token1 from the Splunk UI. You can find the workshop Access Token by clicking &#187; bottom left and then selecting Settings → Access Tokens.
Expand the workshop token that your host has instructed you to use e.g. O11y-Workshop-ACCESS, then click on Show Token to expose your token.">
<link rel=preload href=/observability-workshop/v4.7/scss/main.min.5f8c3c6125570efd6840d5ae69619240bb33adb38c2ed5a72ddf29890e66afcb.css as=style>
<link href=/observability-workshop/v4.7/scss/main.min.5f8c3c6125570efd6840d5ae69619240bb33adb38c2ed5a72ddf29890e66afcb.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
</head>
<body class=td-page>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" id=navbar1>
<a class=navbar-brand href=/observability-workshop/v4.7/>
<span class=navbar-logo><img class=navbar-logo src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAvCAIAAAD8RQT7AAACwklEQVRYw+2YW2jTYBTHu4l4F1ERVMQL+qKgMBUU9EEfRAURUUFfBEUEBRGfdC+CrVt3cdbNSZ1zXqar024yp9MJKzh3FScyO+q8MDW3pvc2TZqkudSvtD4J66fkWyL0kNeQH8mX8/+dY8JMZuNcpjzNX9JQK64ZiEZlk9zDEe/aOmPQ8FIKlJpKtH+mNzUYg+Z38a7vvu2NRqHJlDhABPY0G4UmU8lhOnioFSu0GIImU9KXUOhYOz75kiFoMiVjsfDpl/i0UrQ0oePPkp5ACq5kHxs978JnlaHsxQVm/24H3zUGyaRE+Jj5DTGvEm0yeNfVsfeGVVGGYQJtk6kaIBfZ0OYUufBKrKRHCSWgmAQ5fmOIWl6DNjXx6dbwqRfgh4L6eJLC3v/oXW1HnOGFlsDeR0L3TygmEC+tn+j19ciNgt5Qzznc4B3AUPGd33xb7yL3G3LJVaaiX4kKMExCD+bf2YTctvCZZZEzndJYBIZJfE8F9jtBE0HsfpMswQNOoR+HYWIbPkyQiQIr4pyelKyOQ5No8UyoF1PLahjboMqIhqABl3/HA6EX05kGyEboSBuQIZ2/FDGnInKuSyaZnKcYLU32lMTF3P05ITHVb8nFNiQ09MZbXPPI+H9QliMuMuV9xIIqBN2vwAy8HTKw0gJ0sZuYW6l9MuBTS8MnnkujQSgOPxctdhGzy7VPTWL+5eiF1+ABUJJKMpGzr4CHaG8U1KrauH0IHEAot/kRDZ/swKeUaG9bvi13Em2jKUWF4gDDzdGn/zbcmHJE4MEWcZCAFPWk2xc8/ATcpbGl4zOsYFCC1IOsIex7/KchaEMj0ywkh9CH+3c59J8104uLbY36T758x1d68229twIZ+y+6qffGRFa5Jrd3jR3Td5ukJhVgr9TKWp03benp9fo7cmm1/lvImLUXDN757XWe5v+g+QU6sNkgKUPrgwAAAABJRU5ErkJggg=="></span><span class=font-weight-bold>Splunk Observability Cloud Workshops</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
</ul>
</div>
</nav>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" id=navbar2>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/observability-workshop/v4.7/imt/><span class=active>Splunk IMT</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/observability-workshop/v4.7/apm/><span>Splunk APM</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/observability-workshop/v4.7/synthetics/><span>Splunk Synthetics</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/observability-workshop/v4.7/rum/><span>Splunk RUM</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/observability-workshop/v4.7/bootcamp/><span>Observability Bootcamp</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/observability-workshop/v4.7/resources/><span>Resources</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
Releases
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/latest/>latest</a>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/v4.6>v4.6</a>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/v4.7>v4.7</a>
</div>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
English
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/observability-workshop/v4.7/ja/imt/docs/gdi/k3s/>日本語</a>
</div>
</li>
</ul>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
<div id=td-sidebar-menu class=td-sidebar__inner>
<form class="td-sidebar__search d-flex align-items-center">
<input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/observability-workshop/v4.7/offline-search-index.a0535b2d5184d3b00ae788c7d4c4a17f.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation">
</button>
</form>
<nav class="collapse td-sidebar-nav" id=td-section-nav>
<div class="nav-item dropdown d-block d-lg-none">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
English
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/observability-workshop/v4.7/ja/imt/docs/gdi/k3s/>日本語</a>
</div>
</div>
<ul class="td-sidebar-nav__section pr-md-3 ul-0">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-observability-workshopv47imt-li>
<a href=/observability-workshop/v4.7/imt/ title=Introduction class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-observability-workshopv47imt><span>Splunk IMT</span></a>
<ul class=ul-1>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-observability-workshopv47imtdocs-li>
<a href=/observability-workshop/v4.7/imt/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv47imtdocs><span>Setup and Exercises</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsinitial-setup-li>
<a href=/observability-workshop/v4.7/imt/docs/initial-setup/ title="How to connect to your workshop environment" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsinitial-setup><span>Access AWS/EC2 Instance</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-observability-workshopv47imtdocsgdi-li>
<a href=/observability-workshop/v4.7/imt/docs/gdi/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv47imtdocsgdi><span>Get Data In</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-observability-workshopv47imtdocsgdik3s-li>
<a href=/observability-workshop/v4.7/imt/docs/gdi/k3s/ title="Deploying the OpenTelemetry Collector in Kubernetes" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsgdik3s><span class=td-sidebar-nav-active-item>Deploy the OTel Collector</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsgdinginx-li>
<a href=/observability-workshop/v4.7/imt/docs/gdi/nginx/ title="Deploying NGINX in K3s" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsgdinginx><span>Deploy and Monitor NGIX</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv47imtdocsdashboards-li>
<a href=/observability-workshop/v4.7/imt/docs/dashboards/ title="Working with Dashboards" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv47imtdocsdashboards><span>Dashboards</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdashboardsintro-li>
<a href=/observability-workshop/v4.7/imt/docs/dashboards/intro/ title="Working with Dashboards, Charts and Metrics" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdashboardsintro><span>Introduction</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdashboardsediting-li>
<a href=/observability-workshop/v4.7/imt/docs/dashboards/editing/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdashboardsediting><span>Editing charts</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdashboardssavingcharts-li>
<a href=/observability-workshop/v4.7/imt/docs/dashboards/savingcharts/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdashboardssavingcharts><span>Saving charts</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdashboardsfiltering-li>
<a href=/observability-workshop/v4.7/imt/docs/dashboards/filtering/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdashboardsfiltering><span>Using Filters & Formulas</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdashboardssignalflow-li>
<a href=/observability-workshop/v4.7/imt/docs/dashboards/signalflow/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdashboardssignalflow><span>SignalFlow</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdashboardsadding-charts-li>
<a href=/observability-workshop/v4.7/imt/docs/dashboards/adding-charts/ title="Adding charts to dashboards" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdashboardsadding-charts><span>Adding more charts</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdashboardsdashboarding-li>
<a href=/observability-workshop/v4.7/imt/docs/dashboards/dashboarding/ title="Adding Notes and Dashboard Layout" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdashboardsdashboarding><span>Notes and layout</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv47imtdocsdetectors-li>
<a href=/observability-workshop/v4.7/imt/docs/detectors/ title="Working with Detectors" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv47imtdocsdetectors><span>Detectors</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdetectorscreating-li>
<a href=/observability-workshop/v4.7/imt/docs/detectors/creating/ title="Working with Detectors - Lab Summary" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdetectorscreating><span>Creating a Detector</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsdetectorsmuting-li>
<a href=/observability-workshop/v4.7/imt/docs/detectors/muting/ title="Working with Muting Rules - Lab Summary" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsdetectorsmuting><span>Creating a Muting Rule</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv47imtdocsmonitoring-as-code-li>
<a href=/observability-workshop/v4.7/imt/docs/monitoring-as-code/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv47imtdocsmonitoring-as-code><span>Monitoring as Code</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsmonitoring-as-codeterraform-li>
<a href=/observability-workshop/v4.7/imt/docs/monitoring-as-code/terraform/ title="Monitoring as Code" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsmonitoring-as-codeterraform><span>Plan, Apply, Destroy</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv47imtdocsservicebureau-li>
<a href=/observability-workshop/v4.7/imt/docs/servicebureau/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv47imtdocsservicebureau><span>Service Bureau</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsservicebureaubilling-and-usage-li>
<a href=/observability-workshop/v4.7/imt/docs/servicebureau/billing-and-usage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsservicebureaubilling-and-usage><span>Billing and Usage</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsservicebureauteams-li>
<a href=/observability-workshop/v4.7/imt/docs/servicebureau/teams/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsservicebureauteams><span>Teams</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv47imtdocsservicebureautokens-li>
<a href=/observability-workshop/v4.7/imt/docs/servicebureau/tokens/ title="Controlling Usage" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv47imtdocsservicebureautokens><span>Control Usage</span></a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
<aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
</div>
<div class=td-toc><nav id=TableOfContents>
<ul>
<li><a href=#1-obtain-access-token>1. Obtain Access Token</a></li>
<li><a href=#2-installation-using-helm>2. Installation using Helm</a></li>
<li><a href=#3-validate-metrics-in-the-ui>3. Validate metrics in the UI</a></li>
</ul>
</nav></div>
<div class="taxonomy taxonomy-terms-cloud taxo-tags">
<h5 class=taxonomy-title>Tag Cloud</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=https://signalfx.github.io/observability-workshop/v4.7/tags/k3s/ data-taxonomy-term=k3s><span class=taxonomy-label>k3s</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=https://signalfx.github.io/observability-workshop/v4.7/tags/ngnix/ data-taxonomy-term=ngnix><span class=taxonomy-label>NGNIX</span><span class=taxonomy-count>1</span></a></li>
</ul>
</div>
<div class="taxonomy taxonomy-terms-cloud taxo-categories">
<h5 class=taxonomy-title>Categories</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=https://signalfx.github.io/observability-workshop/v4.7/categories/imt/ data-taxonomy-term=imt><span class=taxonomy-label>IMT</span><span class=taxonomy-count>2</span></a></li>
</ul>
</div>
</aside>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<nav aria-label=breadcrumb class=td-breadcrumbs>
<ol class=breadcrumb>
<li class=breadcrumb-item>
<a href=https://signalfx.github.io/observability-workshop/v4.7/imt/>Splunk IMT</a>
</li>
<li class=breadcrumb-item>
<a href=https://signalfx.github.io/observability-workshop/v4.7/imt/docs/>Setup and Exercises</a>
</li>
<li class=breadcrumb-item>
<a href=https://signalfx.github.io/observability-workshop/v4.7/imt/docs/gdi/>Get Data In</a>
</li>
<li class="breadcrumb-item active" aria-current=page>
<a href=https://signalfx.github.io/observability-workshop/v4.7/imt/docs/gdi/k3s/>Deploy the OTel Collector</a>
</li>
</ol>
</nav>
<div class=td-content>
<h1>Deploying the OpenTelemetry Collector in Kubernetes</h1>
<header class=article-meta>
<div class="taxonomy taxonomy-terms-article taxo-tags">
<h5 class=taxonomy-title>Tags:</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=https://signalfx.github.io/observability-workshop/v4.7/tags/k3s/ data-taxonomy-term=k3s><span class=taxonomy-label>k3s</span></a></li>
</ul>
</div>
<div class="taxonomy taxonomy-terms-article taxo-categories">
<h5 class=taxonomy-title>Categories:</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=https://signalfx.github.io/observability-workshop/v4.7/categories/imt/ data-taxonomy-term=imt><span class=taxonomy-label>IMT</span></a></li>
</ul>
</div>
<p class=reading-time><i class="fa fa-clock" aria-hidden=true></i>&nbsp; 5 minute read &nbsp;</p>
</header>
<ul>
<li>Use the Splunk Helm chart to install the OpenTelemetry Collector in K3s</li>
<li>Explore your cluster in the Kubernetes Navigator</li>
</ul>
<hr>
<h2 id=1-obtain-access-token>1. Obtain Access Token</h2>
<p>You will need to obtain your Access Token<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> from the Splunk UI. You can find the workshop Access Token by clicking <strong>&#187;</strong> bottom left and then selecting <strong>Settings → Access Tokens</strong>.</p>
<p>Expand the workshop token that your host has instructed you to use e.g. <strong>O11y-Workshop-ACCESS</strong>, then click on <strong>Show Token</strong> to expose your token. Click the
<strong class="label-button ui-button-grey" role=label-button>
Copy
</strong>
&nbsp; button to copy to clipboard. Please do not use the <strong>Default</strong> token!</p>
<p><img src=../../../images/access-token.png alt="Access Token"></p>
<div class="alert alert-warning" role=alert>
<p class=alert-heading>Please do not attempt to create your own token</p>
<p class=alert-body>
This will complicate our clean process after the workshop.
However if you do, please make sure it has only <strong>INGEST</strong> & <strong>API</strong> as scope!!
</p>
</div>
<p>You will also need to obtain the name of the Realm<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> for your Splunk account. At the top of the side menu, click on your name and select <strong>Account Settings</strong>. The Realm can be found in the middle of the page within the Organizations section. In this example it is <code>us0</code>.</p>
<p><img src=../../../images/account-settings.png alt="Account Settings"></p>
<h2 id=2-installation-using-helm>2. Installation using Helm</h2>
<p>Create the <code>ACCESS_TOKEN</code> and <code>REALM</code> environment variables to use in the proceeding Helm install command. For instance, if your realm is <code>us1</code>, you would type <code>export REALM=us1</code> and for <code>eu0</code> type <code>export REALM=eu0</code>.</p>
<ul class="nav nav-tabs" id=tabs-2 role=tablist><li class=nav-item>
<a class="nav-link active tab-Export-Variables" id=tabs-2-0-tab data-toggle=tab href=#tabs-2-0 role=tab onclick='handleClick("Export-Variables")' aria-controls=tabs-2-0 aria-selected=true>
Export Variables
</a>
</li></ul>
<div class=tab-content id=tabs-2-content><div class="tab-pane fade show active" id=tabs-2-0 role=tabpanel aria-labelled-by=tabs-2-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#204a87>export</span> <span style=color:#000>ACCESS_TOKEN</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;replace_with_O11y-Workshop-ACCESS_token&gt;
<span style=color:#204a87>export</span> <span style=color:#000>REALM</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;replace_with_splunk_realm&gt;</code></pre></div></div>
</div>
<p>Install the OpenTelemetry Collector using the Splunk Helm chart. First, add the Splunk Helm chart repository to Helm and update.
<ul class="nav nav-tabs" id=tabs-3 role=tablist><li class=nav-item>
<a class="nav-link active tab-Helm-Repo-Add" id=tabs-3-0-tab data-toggle=tab href=#tabs-3-0 role=tab onclick='handleClick("Helm-Repo-Add")' aria-controls=tabs-3-0 aria-selected=true>
Helm Repo Add
</a>
</li><li class=nav-item>
<a class="nav-link tab-Helm-Repo-Add-Output" id=tabs-3-1-tab data-toggle=tab href=#tabs-3-1 role=tab onclick='handleClick("Helm-Repo-Add-Output")' aria-controls=tabs-3-1 aria-selected=false>
Helm Repo Add Output
</a>
</li></ul>
<div class=tab-content id=tabs-3-content><div class="tab-pane fade show active" id=tabs-3-0 role=tabpanel aria-labelled-by=tabs-3-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart <span style=color:#ce5c00;font-weight:700>&amp;&amp;</span> helm repo update</code></pre></div></div>
<div class="tab-pane fade" id=tabs-3-1 role=tabpanel aria-labelled-by=tabs-3-1-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>Using ACCESS_TOKEN=&lt;redacted&gt;
Using REALM=eu0
&#34;splunk-otel-collector-chart&#34; has been added to your repositories
Using ACCESS_TOKEN=&lt;redacted&gt;
Using REALM=eu0
Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the &#34;splunk-otel-collector-chart&#34; chart repository
Update Complete. ⎈Happy Helming!⎈</code></pre></div></div>
</div>
</p>
<p>Install the OpenTelemetry Collector Helm chart with the following commands, do <strong>NOT</strong> edit this:</p>
<ul class="nav nav-tabs" id=tabs-4 role=tablist><li class=nav-item>
<a class="nav-link active tab-Helm-Install" id=tabs-4-0-tab data-toggle=tab href=#tabs-4-0 role=tab onclick='handleClick("Helm-Install")' aria-controls=tabs-4-0 aria-selected=true>
Helm Install
</a>
</li><li class=nav-item>
<a class="nav-link tab-Helm-Install-Output" id=tabs-4-1-tab data-toggle=tab href=#tabs-4-1 role=tab onclick='handleClick("Helm-Install-Output")' aria-controls=tabs-4-1 aria-selected=false>
Helm Install Output
</a>
</li></ul>
<div class=tab-content id=tabs-4-content><div class="tab-pane fade show active" id=tabs-4-0 role=tabpanel aria-labelled-by=tabs-4-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>    helm install splunk-otel-collector <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    --set<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;splunkObservability.realm=</span><span style=color:#000>$REALM</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    --set<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;splunkObservability.accessToken=</span><span style=color:#000>$ACCESS_TOKEN</span><span style=color:#4e9a06>&#34;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    --set<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;clusterName=</span><span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>-k3s-cluster&#34;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    --set<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;splunkObservability.logsEnabled=true&#34;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    --set<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;environment=</span><span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>-apm-env&#34;</span> <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    splunk-otel-collector-chart/splunk-otel-collector <span style=color:#4e9a06>\
</span><span style=color:#4e9a06></span>    -f ~/workshop/k3s/otel-collector.yaml</code></pre></div></div>
<div class="tab-pane fade" id=tabs-4-1 role=tabpanel aria-labelled-by=tabs-4-1-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>Using ACCESS_TOKEN=&lt;redacted&gt;
Using REALM=eu0
NAME: splunk-otel-collector
LAST DEPLOYED: Fri May  7 11:19:01 2021
NAMESPACE: default
STATUS: deployed
REVISION: 1
TEST SUITE: None</code></pre></div></div>
</div>
<p>You can monitor the progress of the deployment by running <code>kubectl get pods</code> which should typically report a new pod is up and running after about 30 seconds.</p>
<p>Ensure the status is reported as Running before continuing.</p>
<ul class="nav nav-tabs" id=tabs-5 role=tablist><li class=nav-item>
<a class="nav-link active tab-Kubectl-Get-Pods" id=tabs-5-0-tab data-toggle=tab href=#tabs-5-0 role=tab onclick='handleClick("Kubectl-Get-Pods")' aria-controls=tabs-5-0 aria-selected=true>
Kubectl Get Pods
</a>
</li><li class=nav-item>
<a class="nav-link tab-Kubectl-Get-Pods-Output" id=tabs-5-1-tab data-toggle=tab href=#tabs-5-1 role=tab onclick='handleClick("Kubectl-Get-Pods-Output")' aria-controls=tabs-5-1 aria-selected=false>
Kubectl Get Pods Output
</a>
</li></ul>
<div class=tab-content id=tabs-5-content><div class="tab-pane fade show active" id=tabs-5-0 role=tabpanel aria-labelled-by=tabs-5-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl get pods</code></pre></div></div>
<div class="tab-pane fade" id=tabs-5-1 role=tabpanel aria-labelled-by=tabs-5-1-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>NAME                                                          READY   STATUS    RESTARTS   AGE
splunk-otel-collector-agent-2sk6k                             0/1     Running   0          10s
splunk-otel-collector-k8s-cluster-receiver-6956d4446f-gwnd7   0/1     Running   0          10s</code></pre></div></div>
</div>
<p>Ensure there are no errors by tailing the logs from the OpenTelemetry Collector pod. Output should look similar to the log output shown in the Output tab below.</p>
<p>Use the label set by the <code>helm</code> install to tail logs (You will need to press ++ctrl+c++ to exit). Or use the installed <code>k9s</code> terminal UI for bonus points!</p>
<ul class="nav nav-tabs" id=tabs-6 role=tablist><li class=nav-item>
<a class="nav-link active tab-Kubectl-Logs" id=tabs-6-0-tab data-toggle=tab href=#tabs-6-0 role=tab onclick='handleClick("Kubectl-Logs")' aria-controls=tabs-6-0 aria-selected=true>
Kubectl Logs
</a>
</li><li class=nav-item>
<a class="nav-link tab-Kubectl-Logs-Output" id=tabs-6-1-tab data-toggle=tab href=#tabs-6-1 role=tab onclick='handleClick("Kubectl-Logs-Output")' aria-controls=tabs-6-1 aria-selected=false>
Kubectl Logs Output
</a>
</li></ul>
<div class=tab-content id=tabs-6-content><div class="tab-pane fade show active" id=tabs-6-0 role=tabpanel aria-labelled-by=tabs-6-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>kubectl logs -l <span style=color:#000>app</span><span style=color:#ce5c00;font-weight:700>=</span>splunk-otel-collector -f --container otel-collector</code></pre></div></div>
<div class="tab-pane fade" id=tabs-6-1 role=tabpanel aria-labelled-by=tabs-6-1-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>2021-03-21T16:11:10.900Z        INFO    service/service.go:364  Starting receivers...
2021-03-21T16:11:10.900Z        INFO    builder/receivers_builder.go:70 Receiver is starting... {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;prometheus&#34;, &#34;component_name&#34;: &#34;prometheus&#34;}
2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:75 Receiver started.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;prometheus&#34;, &#34;component_name&#34;: &#34;prometheus&#34;}
2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:70 Receiver is starting... {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
2021-03-21T16:11:11.009Z        INFO    k8sclusterreceiver@v0.21.0/watcher.go:195       Configured Kubernetes MetadataExporter  {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;, &#34;exporter_name&#34;: &#34;signalfx&#34;}
2021-03-21T16:11:11.009Z        INFO    builder/receivers_builder.go:75 Receiver started.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
2021-03-21T16:11:11.009Z        INFO    healthcheck/handler.go:128      Health Check state change       {&#34;component_kind&#34;: &#34;extension&#34;, &#34;component_type&#34;: &#34;health_check&#34;, &#34;component_name&#34;: &#34;health_check&#34;, &#34;status&#34;: &#34;ready&#34;}
2021-03-21T16:11:11.009Z        INFO    service/service.go:267  Everything is ready. Begin running and processing data.
2021-03-21T16:11:11.009Z        INFO    k8sclusterreceiver@v0.21.0/receiver.go:59       Starting shared informers and wait for initial cache sync.      {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}
2021-03-21T16:11:11.281Z        INFO    k8sclusterreceiver@v0.21.0/receiver.go:75       Completed syncing shared informer caches.       {&#34;component_kind&#34;: &#34;receiver&#34;, &#34;component_type&#34;: &#34;k8s_cluster&#34;, &#34;component_name&#34;: &#34;k8s_cluster&#34;}</code></pre></div></div>
</div>
<div class="alert alert-info" role=alert>
<p class=alert-heading>Deleting a failed installation</p>
<p class=alert-body>
If you make an error installing the OpenTelemetry Collector you can start over by deleting the installation using:
<b> helm delete splunk-otel-collector</b>
</p>
</div>
<hr>
<h2 id=3-validate-metrics-in-the-ui>3. Validate metrics in the UI</h2>
<p>In the Splunk UI, click the <strong>&#187;</strong> bottom left and click on <strong>Infrastructure</strong>.</p>
<p><img src=../../../images/clustermap-nav.png alt="Selecting the Kubernetes Navigator Map"></p>
<p>Under <strong>Containers</strong> click on <strong>Kubernetes</strong> to open the Kubernetes Navigator Cluster Map to ensure metrics are being sent in.</p>
<p>Validate that your cluster is discovered and reporting by finding your cluster (in the workshop you will see many other clusters). To find your cluster name run the following command and copy the output to your clipboard:</p>
<ul class="nav nav-tabs" id=tabs-8 role=tablist><li class=nav-item>
<a class="nav-link active tab-Echo-Cluster-Name" id=tabs-8-0-tab data-toggle=tab href=#tabs-8-0 role=tab onclick='handleClick("Echo-Cluster-Name")' aria-controls=tabs-8-0 aria-selected=true>
Echo Cluster Name
</a>
</li></ul>
<div class=tab-content id=tabs-8-content><div class="tab-pane fade show active" id=tabs-8-0 role=tabpanel aria-labelled-by=tabs-8-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#204a87>echo</span> <span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span>-k3s-cluster</code></pre></div></div>
</div>
<p>Then in the UI, click on the &ldquo;Cluster: - " menu just below the Splunk Logo, and paste the Cluster name you just copied into the search box, click the box to select your cluster, and finally click off the menu into white space to apply the filter.</p>
<p><img src=../../../images/search-k3s-cluster.png alt="K8S Clusters Filter"></p>
<p><img src=../../../images/selecting-k3s-cluster.png alt="Select K8S Cluster"></p>
<p><img src=../../../images/filtered-k3s-cluster.png alt="Filtered K8S Cluster"></p>
<p>To examine the health of your node, hover over the pale blue background of your cluster, then click on the blue magnifying glass <img src=../../../images/blue-cross.png alt="Magnifying Glass"> that appears in the top left hand corner.</p>
<p>This will drill down to the node level. Next, open the side bar by clicking on the side bar button to open the Metrics side bar.</p>
<p>Once it is open, you can use the slider on the side to explore the various charts relevant to your cluster/node: CPU, Memory, Network, Events etc.</p>
<p><img src=../../../images/explore-metrics.png alt="Sidebar metrics"></p>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>Access Tokens (sometimes called Org Tokens) are long-lived organization-level tokens. By default, these tokens persist for 5 years, and thus are suitable for embedding into emitters that send data points over long periods of time, or for any long-running scripts that call the Splunk API.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:2 role=doc-endnote>
<p>A realm is a self-contained deployment of Splunk in which your Organization is hosted. Different realms have different API endpoints (e.g. the endpoint for sending data is <code>ingest.us1.signalfx.com</code> for the <strong><code>us1</code></strong> realm, and <code>ingest.eu0.signalfx.com</code> for the <strong><code>eu0</code></strong> realm). This realm name is shown on your profile page in the Splunk UI. If you do not include the realm name when specifying an endpoint, Splunk will interpret it as pointing to the <strong><code>us0</code></strong> realm.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter>
<a class=text-white target=_blank rel=noopener href=https://twitter.com/splunk aria-label=Twitter>
<i class="fab fa-twitter"></i>
</a>
</li>
</ul>
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/signalfx/observability-workshop aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2022 Splunk Inc. All Rights Reserved</small>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/observability-workshop/v4.7/js/tabpane-persist.js></script>
<script src=/observability-workshop/v4.7/js/main.min.8ab8f81ff7e1454d30024cd6f956d4d341c3a97e2a673f988065f2ee4e147922.js integrity="sha256-irj4H/fhRU0wAkzW+VbU00HDqX4qZz+YgGXy7k4UeSI=" crossorigin=anonymous></script>
</body>
</html>