<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/observability-workshop/v4.49/favicons/favicon.ico><link rel=apple-touch-icon href=/observability-workshop/v4.49/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/observability-workshop/v4.49/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/observability-workshop/v4.49/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/observability-workshop/v4.49/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/observability-workshop/v4.49/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/observability-workshop/v4.49/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/observability-workshop/v4.49/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/observability-workshop/v4.49/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/observability-workshop/v4.49/favicons/android-192x192.png sizes=192x192><title>Instrument REVIEWS for Tracing | Splunk Observability Cloud Workshops</title><meta name=description content="1. Use Data Setup to instrument a Python application Within the O11y Cloud UI:
Data Setup -&amp;gt; Monitor Applications -&amp;gt; Python (traces) -&amp;gt; Add Integration
Provide the following to the Configure Integration Wizard:
Service: review
Django: no
collector endpoint: http://localhost:4317
Environment: rtapp-workshop-[YOURNAME]
Kubernetes: yes
Legacy Agent: no
We are instructed to:
Install the instrumentation packages for your Python environment.
pip install splunk-opentelemetry[all] splunk-py-trace-bootstrap Configure the Downward API to expose environment variables to Kubernetes resources."><meta property="og:title" content="Instrument REVIEWS for Tracing"><meta property="og:description" content="1. Use Data Setup to instrument a Python application Within the O11y Cloud UI:
Data Setup -> Monitor Applications -> Python (traces) -> Add Integration
Provide the following to the Configure Integration Wizard:
Service: review
Django: no
collector endpoint: http://localhost:4317
Environment: rtapp-workshop-[YOURNAME]
Kubernetes: yes
Legacy Agent: no
We are instructed to:
Install the instrumentation packages for your Python environment.
pip install splunk-opentelemetry[all] splunk-py-trace-bootstrap Configure the Downward API to expose environment variables to Kubernetes resources."><meta property="og:type" content="article"><meta property="og:url" content="https://splunk.github.io/observability-workshop/v4.49/tko/session-2/docs/instrument/"><meta property="article:section" content="tko"><meta property="article:modified_time" content="2023-02-02T10:10:11+00:00"><meta property="og:site_name" content="Splunk Observability Cloud Workshops"><meta itemprop=name content="Instrument REVIEWS for Tracing"><meta itemprop=description content="1. Use Data Setup to instrument a Python application Within the O11y Cloud UI:
Data Setup -> Monitor Applications -> Python (traces) -> Add Integration
Provide the following to the Configure Integration Wizard:
Service: review
Django: no
collector endpoint: http://localhost:4317
Environment: rtapp-workshop-[YOURNAME]
Kubernetes: yes
Legacy Agent: no
We are instructed to:
Install the instrumentation packages for your Python environment.
pip install splunk-opentelemetry[all] splunk-py-trace-bootstrap Configure the Downward API to expose environment variables to Kubernetes resources."><meta itemprop=dateModified content="2023-02-02T10:10:11+00:00"><meta itemprop=wordCount content="788"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Instrument REVIEWS for Tracing"><meta name=twitter:description content="1. Use Data Setup to instrument a Python application Within the O11y Cloud UI:
Data Setup -> Monitor Applications -> Python (traces) -> Add Integration
Provide the following to the Configure Integration Wizard:
Service: review
Django: no
collector endpoint: http://localhost:4317
Environment: rtapp-workshop-[YOURNAME]
Kubernetes: yes
Legacy Agent: no
We are instructed to:
Install the instrumentation packages for your Python environment.
pip install splunk-opentelemetry[all] splunk-py-trace-bootstrap Configure the Downward API to expose environment variables to Kubernetes resources."><link rel=preload href=/observability-workshop/v4.49/scss/main.min.0ef03532d41f034301006c240b1b1b3ba1d862feedd9d9b1ac802dc7e9aef254.css as=style><link href=/observability-workshop/v4.49/scss/main.min.0ef03532d41f034301006c240b1b1b3ba1d862feedd9d9b1ac802dc7e9aef254.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" id=navbar1><a class=navbar-brand href=/observability-workshop/v4.49/><span class=navbar-logo><img class=navbar-logo src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAvCAIAAAD8RQT7AAACwklEQVRYw+2YW2jTYBTHu4l4F1ERVMQL+qKgMBUU9EEfRAURUUFfBEUEBRGfdC+CrVt3cdbNSZ1zXqar024yp9MJKzh3FScyO+q8MDW3pvc2TZqkudSvtD4J66fkWyL0kNeQH8mX8/+dY8JMZuNcpjzNX9JQK64ZiEZlk9zDEe/aOmPQ8FIKlJpKtH+mNzUYg+Z38a7vvu2NRqHJlDhABPY0G4UmU8lhOnioFSu0GIImU9KXUOhYOz75kiFoMiVjsfDpl/i0UrQ0oePPkp5ACq5kHxs978JnlaHsxQVm/24H3zUGyaRE+Jj5DTGvEm0yeNfVsfeGVVGGYQJtk6kaIBfZ0OYUufBKrKRHCSWgmAQ5fmOIWl6DNjXx6dbwqRfgh4L6eJLC3v/oXW1HnOGFlsDeR0L3TygmEC+tn+j19ciNgt5Qzznc4B3AUPGd33xb7yL3G3LJVaaiX4kKMExCD+bf2YTctvCZZZEzndJYBIZJfE8F9jtBE0HsfpMswQNOoR+HYWIbPkyQiQIr4pyelKyOQ5No8UyoF1PLahjboMqIhqABl3/HA6EX05kGyEboSBuQIZ2/FDGnInKuSyaZnKcYLU32lMTF3P05ITHVb8nFNiQ09MZbXPPI+H9QliMuMuV9xIIqBN2vwAy8HTKw0gJ0sZuYW6l9MuBTS8MnnkujQSgOPxctdhGzy7VPTWL+5eiF1+ABUJJKMpGzr4CHaG8U1KrauH0IHEAot/kRDZ/swKeUaG9bvi13Em2jKUWF4gDDzdGn/zbcmHJE4MEWcZCAFPWk2xc8/ATcpbGl4zOsYFCC1IOsIex7/KchaEMj0ywkh9CH+3c59J8104uLbY36T758x1d68229twIZ+y+6qffGRFa5Jrd3jR3Td5ukJhVgr9TKWp03benp9fo7cmm1/lvImLUXDN757XWe5v+g+QU6sNkgKUPrgwAAAABJRU5ErkJggg=="></span><span class=font-weight-bold>Splunk Observability Cloud Workshops</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"></ul></div></nav><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" id=navbar2><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/observability-workshop/v4.49/imt/><span>Splunk IM</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/observability-workshop/v4.49/apm/><span>Splunk APM</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/observability-workshop/v4.49/synthetics/><span>Splunk Synthetics</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/observability-workshop/v4.49/rum/><span>Splunk RUM</span></a></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>More Workshops</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=https://splunk.github.io/observability-workshop/latest/pet-clinic/>Pet Clinic Java Workshop</a>
<a class=dropdown-item href=https://splunk.github.io/observability-workshop/latest/bootcamp/>O11y Bootcamp</a>
<a class=dropdown-item href=https://splunk.github.io/observability-workshop/latest/resources/>Resources</a></div></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Releases</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=https://splunk.github.io/observability-workshop/latest/>latest</a>
<a class=dropdown-item href=https://splunk.github.io/observability-workshop/v4.48>v4.48</a>
<a class=dropdown-item href=https://splunk.github.io/observability-workshop/v4.49>v4.49</a></div></li><li class="nav-item dropdown mr-4 d-none d-lg-block"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/observability-workshop/v4.49/ja/>日本語</a></div></li></ul></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/observability-workshop/v4.49/offline-search-index.a42fa6444b6afef39940fbcf3d558324.json data-offline-search-base-href=/ data-offline-search-max-results=10></div><button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-section-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><div class="nav-item dropdown d-block d-lg-none"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>English</a><div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/observability-workshop/v4.49/ja/>日本語</a></div></div><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-observability-workshopv449tko-li><a href=/observability-workshop/v4.49/tko/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-observability-workshopv449tko><span>TKO Workshops</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-1-li><a href=/observability-workshop/v4.49/tko/session-1/ title="1. Role Play Qualification / Discovery - with SRE and ITOPs" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv449tkosession-1><span>Session 1</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-observability-workshopv449tkosession-2-li><a href=/observability-workshop/v4.49/tko/session-2/ title="2. Getting Data In (GDI) & OTEL" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv449tkosession-2><span>Session 2</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-2docsintro-li><a href=/observability-workshop/v4.49/tko/session-2/docs/intro/ title="GDI - Real Time Enrichment Workshop" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-2docsintro><span>Introduction</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-2docsgetting_started-li><a href=/observability-workshop/v4.49/tko/session-2/docs/getting_started/ title="GDI - Real Time Enrichment Workshop" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-2docsgetting_started><span>Getting started</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-2docsdeploy-li><a href=/observability-workshop/v4.49/tko/session-2/docs/deploy/ title="Deploy complex environments and capture meterics" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-2docsdeploy><span>Deployment</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-2docscode_to_python-li><a href=/observability-workshop/v4.49/tko/session-2/docs/code_to_python/ title="Code to Kubernetes - Python" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-2docscode_to_python><span>Code to Kubernetes</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-observability-workshopv449tkosession-2docsinstrument-li><a href=/observability-workshop/v4.49/tko/session-2/docs/instrument/ title="Instrument REVIEWS for Tracing" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-2docsinstrument><span class=td-sidebar-nav-active-item>Instrumentation</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-3-li><a href=/observability-workshop/v4.49/tko/session-3/ title="3. ITOps Monitoring Monitoring Monitoring" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv449tkosession-3><span>Session 3</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-4-li><a href=/observability-workshop/v4.49/tko/session-4/ title="4. ITOps - Understanding Event Analytics in Realistic Business Services" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv449tkosession-4><span>Session 4</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv449tkosession-5-li><a href=/observability-workshop/v4.49/tko/session-5/ title="5. How Platform Engineers Observe Kubernetes - Workshop" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv449tkosession-5><span>Session 5</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-5docsdeploy-otel-li><a href=/observability-workshop/v4.49/tko/session-5/docs/deploy-otel/ title="Deploying the OpenTelemetry Collector in Kubernetes using a NameSpace" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-5docsdeploy-otel><span>Prep & Deploy the OTel Collector</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-5docscheck-new-navigator-li><a href=/observability-workshop/v4.49/tko/session-5/docs/check-new-navigator/ title="The New Kubernetes Navigator" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-5docscheck-new-navigator><span>Touring the Kubernetes Navigator v2</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-5docsdeploy-apache-li><a href=/observability-workshop/v4.49/tko/session-5/docs/deploy-apache/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-5docsdeploy-apache><span>Deploying PHP/Apache</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-5docsfix-apache-li><a href=/observability-workshop/v4.49/tko/session-5/docs/fix-apache/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-5docsfix-apache><span>Fix PHP/Apache Issue</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-5docsdeploy-loadgen-li><a href=/observability-workshop/v4.49/tko/session-5/docs/deploy-loadgen/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-5docsdeploy-loadgen><span>Deploy Load Generator</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-5docssetup-hpa-li><a href=/observability-workshop/v4.49/tko/session-5/docs/setup-hpa/ title="Setup Horizontal Pod Autoscaler" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-5docssetup-hpa><span>Setup HPA</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-5docsedit-hpa-li><a href=/observability-workshop/v4.49/tko/session-5/docs/edit-hpa/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-5docsedit-hpa><span>Increase HPA Replicas</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-5docscheck-navigator-li><a href=/observability-workshop/v4.49/tko/session-5/docs/check-navigator/ title="The Kubernetes Navigator" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-5docscheck-navigator><span>Touring the Kubernetes Navigator V1</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv449tkosession-6-li><a href=/observability-workshop/v4.49/tko/session-6/ title="6. O11y - Distributed Tracing for modern applications" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv449tkosession-6><span>Session 6</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-6docssetup-li><a href=/observability-workshop/v4.49/tko/session-6/docs/setup/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-6docssetup><span>Setup</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-6docsvalidate_traces-li><a href=/observability-workshop/v4.49/tko/session-6/docs/validate_traces/ title="Validate Traces are being collected" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-6docsvalidate_traces><span>Validate Traces</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-6docsdeveloper_role-li><a href=/observability-workshop/v4.49/tko/session-6/docs/developer_role/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-6docsdeveloper_role><span>Developer Role</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-6docscustom_attribution-li><a href=/observability-workshop/v4.49/tko/session-6/docs/custom_attribution/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-6docscustom_attribution><span>Custom Attribution</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-6docsfix_issue-li><a href=/observability-workshop/v4.49/tko/session-6/docs/fix_issue/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-6docsfix_issue><span>Fix the issue</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-6docsroot_cause-li><a href=/observability-workshop/v4.49/tko/session-6/docs/root_cause/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-6docsroot_cause><span>Root Cause Analysis</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-6docsbuild_again-li><a href=/observability-workshop/v4.49/tko/session-6/docs/build_again/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-6docsbuild_again><span>Build and Deploy again</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv449tkosession-6docsfinal_fix-li><a href=/observability-workshop/v4.49/tko/session-6/docs/final_fix/ title="The Final Fix!" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv449tkosession-6docsfinal_fix><span>Developer Role (Part 2)</span></a></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#1-use-data-setup-to-instrument-a-python-application>1. Use Data Setup to instrument a Python application</a></li><li><a href=#2-update-the-review-container>2. Update the REVIEW container</a></li><li><a href=#3-update-the-review-deployment-in-kubernetes>3. Update the REVIEW deployment in Kubernetes</a></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://splunk.github.io/observability-workshop/v4.49/tko/>TKO Workshops</a></li><li class=breadcrumb-item><a href=https://splunk.github.io/observability-workshop/v4.49/tko/session-2/>Session 2</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://splunk.github.io/observability-workshop/v4.49/tko/session-2/docs/instrument/ aria-disabled=true class="btn-link disabled">Instrumentation</a></li></ol></nav><div class=td-content><h1>Instrument REVIEWS for Tracing</h1><header class=article-meta><p class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>&nbsp; 4 minute read &nbsp;</p></header><h2 id=1-use-data-setup-to-instrument-a-python-application>1. Use Data Setup to instrument a Python application</h2><p>Within the O11y Cloud UI:</p><p>Data Setup -> Monitor Applications -> Python (traces) -> Add Integration</p><p>Provide the following to the Configure Integration Wizard:</p><ul><li><p>Service: review</p></li><li><p>Django: no</p></li><li><p>collector endpoint: <code>http://localhost:4317</code></p></li><li><p>Environment: rtapp-workshop-[YOURNAME]</p></li><li><p>Kubernetes: yes</p></li><li><p>Legacy Agent: no</p></li></ul><p>We are instructed to:</p><ul><li><p>Install the instrumentation packages for your Python environment.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>pip install splunk-opentelemetry[all]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>splunk-py-trace-bootstrap
</span></span></code></pre></div></li><li><p>Configure the Downward API to expose environment variables to Kubernetes resources.</p><p>For example, update a Deployment to inject environment variables by adding <code>.spec.template.spec.containers.env</code> like:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>your-application</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>myapp</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SPLUNK_OTEL_AGENT</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>valueFrom</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                </span><span style=color:#204a87;font-weight:700>fieldRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>                  </span><span style=color:#204a87;font-weight:700>fieldPath</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>status.hostIP</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OTEL_EXPORTER_OTLP_ENDPOINT</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;http://$(SPLUNK_OTEL_AGENT):4317&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OTEL_SERVICE_NAME</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;review&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OTEL_RESOURCE_ATTRIBUTES</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;deployment.environment=rtapp-workshop-stevel&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></li><li><p>Enable the Splunk OTel Python agent by editing your Python service command.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>splunk-py-trace python3 main.py --port=8000
</span></span></code></pre></div></li><li><p>The actions we must perform include:</p><ul><li>Update the Dockerfile to install the splunk-opentelemetry packages</li><li>Update the deployment.yaml for each service to include these environment variables which will be used by the pod and container.</li><li>Update our Dockerfile for REVIEW so that our program is bootstrapped with splunk-py-trace</li></ul></li></ul><div class="alert alert-info" role=alert><p class=alert-heading>Note</p><div class=alert-body><p class=p-alert-body>We will accomplish this by 1) generating a new requirements.txt file, 2) generating a new container image with an updated Dockerfile for REVIEW and then 3) update the review.deployment.yaml to capture all of these changes.</p></div></div><h2 id=2-update-the-review-container>2. Update the REVIEW container</h2><ul><li><p>Generate a new container image</p></li><li><p>Update the Dockerfile for REVIEW (<code>/workshop/flask_apps_finish/review</code>)</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-dockerfile data-lang=dockerfile><span style=display:flex><span><span style=color:#204a87;font-weight:700>FROM</span><span style=color:#4e9a06> python:3.10-slim</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>WORKDIR</span><span style=color:#4e9a06> /app</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>COPY</span> requirements.txt /app<span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>RUN</span> pip install -r requirements.txt<span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>RUN</span> pip install splunk-opentelemetry<span style=color:#ce5c00;font-weight:700>[</span>all<span style=color:#ce5c00;font-weight:700>]</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>RUN</span> splk-py-trace-bootstrap<span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>COPY</span> ./review.py /app<span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>EXPOSE</span><span style=color:#4e9a06> 5000</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>ENTRYPOINT</span> <span style=color:#000;font-weight:700>[</span> <span style=color:#4e9a06>&#34;splunk-py-trace&#34;</span> <span style=color:#000;font-weight:700>]</span><span style=color:#a40000>
</span></span></span><span style=display:flex><span><span style=color:#a40000></span><span style=color:#204a87;font-weight:700>CMD</span> <span style=color:#000;font-weight:700>[</span> <span style=color:#4e9a06>&#34;python&#34;</span><span style=color:#000;font-weight:700>,</span> <span style=color:#4e9a06>&#34;review.py&#34;</span> <span style=color:#000;font-weight:700>]</span><span style=color:#a40000>
</span></span></span></code></pre></div></li></ul><div class="alert alert-info" role=alert><p class=alert-heading>Note</p><div class=alert-body><p class=p-alert-body>Note that the only lines, in bold, added to the Dockerfile</p></div></div><ul><li><p>Generate a new container image with docker build in the ‘finished’ directory</p></li><li><p>Notice that I have changed the repository name from <code>localhost:8000/review:0.01</code> to <code>localhost:8000/review-splkotel:0.01</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>pwd
</span></span><span style=display:flex><span>./Workshop/flask_apps_finish/review
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>docker build -f Dockerfile.review -t localhost:8000/review-splkotel:0.01 .
</span></span><span style=display:flex><span>[+] Building 27.1s (12/12) FINISHED
</span></span><span style=display:flex><span>=&gt; [internal] load build definition from Dockerfile                                                        0.0s
</span></span><span style=display:flex><span>=&gt; =&gt; transferring dockerfile: 364B                                                                        0.0s
</span></span><span style=display:flex><span>=&gt; [internal] load .dockerignore                                                                           0.0s
</span></span><span style=display:flex><span>=&gt; =&gt; transferring context: 2B                                                                             0.0s
</span></span><span style=display:flex><span>=&gt; [internal] load metadata for docker.io/library/python:3.10-slim                                         1.6s
</span></span><span style=display:flex><span>=&gt; [auth] library/python:pull token for registry-1.docker.io                                               0.0s
</span></span><span style=display:flex><span>=&gt; [1/6] FROM docker.io/library/python:3.10-slim@sha256:54956d6c929405ff651516d5ebbc204203a6415c9d2757aad  0.0s
</span></span><span style=display:flex><span>=&gt; [internal] load build context                                                                           0.3s
</span></span><span style=display:flex><span>=&gt; =&gt; transferring context: 1.91kB                                                                         0.3s
</span></span><span style=display:flex><span>=&gt; CACHED [2/6] WORKDIR /app                                                                               0.0s
</span></span><span style=display:flex><span>=&gt; [3/6] COPY requirements.txt /app                                                                        0.0s
</span></span><span style=display:flex><span>=&gt; [4/6] RUN pip install -r requirements.txt                                                              15.3s
</span></span><span style=display:flex><span>=&gt; [5/6] RUN splk-py-trace-bootstrap                                                                       9.0s
</span></span><span style=display:flex><span>=&gt; [6/6] COPY ./review.py /app                                                                             0.0s
</span></span><span style=display:flex><span>=&gt; exporting to image                                                                                      0.6s
</span></span><span style=display:flex><span>=&gt; =&gt; exporting layers                                                                                     0.6s
</span></span><span style=display:flex><span>=&gt; =&gt; writing image sha256:164977dd860a17743b8d68bcc50c691082bd3bfb352d1025dc3a54b15d5f4c4d                0.0s
</span></span><span style=display:flex><span>=&gt; =&gt; naming to docker.io/localhost:8000/review-splkotel:0.01                                              0.0s
</span></span></code></pre></div></li><li><p>Push the image to Docker Hub with docker push command</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>docker push localhost:8000/review-splkotel:0.01
</span></span><span style=display:flex><span>The push refers to repository [docker.io/localhost:8000/review-splkotel]
</span></span><span style=display:flex><span>682f0e550f2c: Pushed
</span></span><span style=display:flex><span>dd7dfa312442: Pushed
</span></span><span style=display:flex><span>917fd8334695: Pushed
</span></span><span style=display:flex><span>e6782d51030d: Pushed
</span></span><span style=display:flex><span>c6b19a64e528: Mounted from localhost:8000/review
</span></span><span style=display:flex><span>8f52e3bfc0ab: Mounted from localhost:8000/review
</span></span><span style=display:flex><span>f90b85785215: Mounted from localhost:8000/review
</span></span><span style=display:flex><span>d5c0beb90ce6: Mounted from localhost:8000/review
</span></span><span style=display:flex><span>3759be374189: Mounted from localhost:8000/review
</span></span><span style=display:flex><span>fd95118eade9: Mounted from localhost:8000/review
</span></span><span style=display:flex><span>0.01: digest: sha256:3b251059724dbb510ea81424fc25ed03554221e09e90ef965438da33af718a45 size: 2412
</span></span></code></pre></div></li></ul><h2 id=3-update-the-review-deployment-in-kubernetes>3. Update the REVIEW deployment in Kubernetes</h2><ul><li><p>review.deployment.yaml must be updated with the following changes:</p><ul><li>Load the new container image on Docker Hub</li><li>Add environment variables so traces can be emitted to the OTEL collector</li></ul></li><li><p>The deployment must be replaced using the updated review.deployment.yaml</p><ul><li>Update review.deployment.yaml (updates highlighted in bold)</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#204a87;font-weight:700>apiVersion</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>apps/v1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>kind</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>Deployment</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>review</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>review</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline></span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>replicas</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#0000cf;font-weight:700>1</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>selector</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>matchLabels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>review</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>  </span><span style=color:#204a87;font-weight:700>template</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>metadata</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>labels</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>app</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>review</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>    </span><span style=color:#204a87;font-weight:700>spec</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>imagePullSecrets</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>regcred</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>containers</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>image</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>localhost:8000/review-splkotel:0.01</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>review</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>volumeMounts</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>mountPath</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/var/appdata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>appdata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>env</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SPLUNK_OTEL_AGENT</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>valueFrom</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>            </span><span style=color:#204a87;font-weight:700>fieldRef</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>              </span><span style=color:#204a87;font-weight:700>fieldPath</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>status.hostIP</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OTEL_SERVICE_NAME</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;review&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>SPLUNK_METRICS_ENDPOINT</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;http://$(SPLUNK_OTEL_AGENT):9943&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OTEL_EXPORTER_OTLP_ENDPOINT</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#34;http://$(SPLUNK_OTEL_AGENT):4317&#34;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>OTEL_RESOURCE_ATTRIBUTES</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>value</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#4e9a06>&#39;deployment.environment=rtapp-workshop-stevel&#39;</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span><span style=color:#204a87;font-weight:700>volumes</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>      </span>- <span style=color:#204a87;font-weight:700>name</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>appdata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>        </span><span style=color:#204a87;font-weight:700>hostPath</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span><span style=display:flex><span><span style=color:#f8f8f8;text-decoration:underline>          </span><span style=color:#204a87;font-weight:700>path</span><span style=color:#000;font-weight:700>:</span><span style=color:#f8f8f8;text-decoration:underline> </span><span style=color:#000>/var/appdata</span><span style=color:#f8f8f8;text-decoration:underline>
</span></span></span></code></pre></div></li><li><p>Apply review.deployment.yaml. Kubernetes will automatically pick up the changes to the deployment and redeploy new pods with these updates</p><ul><li>Notice that the review-* pod has been restarted</li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>kubectl apply -f review.deployment.yaml
</span></span><span style=display:flex><span>deployment.apps/review configured
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get pods
</span></span><span style=display:flex><span>NAME                                                              READY   STATUS        RESTARTS   AGE
</span></span><span style=display:flex><span>kafka-client                                                      0/1     Unknown       0          155d
</span></span><span style=display:flex><span>curl                                                              0/1     Unknown       0          155d
</span></span><span style=display:flex><span>kafka-zookeeper-0                                                 1/1     Running       0          26h
</span></span><span style=display:flex><span>kafka-2                                                           2/2     Running       0          26h
</span></span><span style=display:flex><span>kafka-exporter-647bddcbfc-h9gp5                                   1/1     Running       2          26h
</span></span><span style=display:flex><span>mongodb-6f6c78c76-kl4vv                                           2/2     Running       0          26h
</span></span><span style=display:flex><span>kafka-1                                                           2/2     Running       1          26h
</span></span><span style=display:flex><span>kafka-0                                                           2/2     Running       1          26h
</span></span><span style=display:flex><span>splunk-otel-collector-1653114277-agent-n4dfn                      2/2     Running       0          26h
</span></span><span style=display:flex><span>splunk-otel-collector-1653114277-k8s-cluster-receiver-5f48v296j   1/1     Running       0          26h
</span></span><span style=display:flex><span>splunk-otel-collector-1653114277-agent-jqxhh                      2/2     Running       0          26h
</span></span><span style=display:flex><span>review-6686859bd7-4pf5d                                           1/1     Running       0          11s
</span></span><span style=display:flex><span>review-5dd8cfd77b-52jbd                                           0/1     Terminating   0          2d10h
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl get pods
</span></span><span style=display:flex><span>NAME                                                              READY   STATUS    RESTARTS   AGE
</span></span><span style=display:flex><span>kafka-client                                                      0/1     Unknown   0          155d
</span></span><span style=display:flex><span>curl                                                              0/1     Unknown   0          155d
</span></span><span style=display:flex><span>kafka-zookeeper-0                                                 1/1     Running   0          26h
</span></span><span style=display:flex><span>kafka-2                                                           2/2     Running   0          26h
</span></span><span style=display:flex><span>kafka-exporter-647bddcbfc-h9gp5                                   1/1     Running   2          26h
</span></span><span style=display:flex><span>mongodb-6f6c78c76-kl4vv                                           2/2     Running   0          26h
</span></span><span style=display:flex><span>kafka-1                                                           2/2     Running   1          26h
</span></span><span style=display:flex><span>kafka-0                                                           2/2     Running   1          26h
</span></span><span style=display:flex><span>splunk-otel-collector-1653114277-agent-n4dfn                      2/2     Running   0          26h
</span></span><span style=display:flex><span>splunk-otel-collector-1653114277-k8s-cluster-receiver-5f48v296j   1/1     Running   0          26h
</span></span><span style=display:flex><span>splunk-otel-collector-1653114277-agent-jqxhh                      2/2     Running   0          26h
</span></span><span style=display:flex><span>review-6686859bd7-4pf5d                                           1/1     Running   0          15s
</span></span></code></pre></div></li></ul><p>Note that traces</p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://twitter.com/splunk aria-label=Twitter><i class="fab fa-twitter"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/splunk/observability-workshop aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Splunk Inc. All Rights Reserved</small></div></div></div></footer></div><script src=/observability-workshop/v4.49/js/main.min.2aff983e9d0d8ecff9ed53e14b657216e2d8d2aff059bf4a5651283020995f1b.js integrity="sha256-Kv+YPp0Njs/57VPhS2VyFuLY0q/wWb9KVlEoMCCZXxs=" crossorigin=anonymous></script>
<script src=/observability-workshop/v4.49/js/tabpane-persist.js></script>
<script>const svgCopy='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg>',svgCheck='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"><path fill-rule="evenodd" fill="rgb(63, 185, 80)" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg>',addCopyButtons=e=>{document.querySelectorAll("pre > code").forEach(t=>{const n=document.createElement("button");n.className="clipboard-button",n.type="button",n.innerHTML=svgCopy,n.addEventListener("click",()=>{e.writeText(t.innerText).then(()=>{n.blur(),n.innerHTML=svgCheck,setTimeout(()=>n.innerHTML=svgCopy,2e3)},e=>n.innerHTML="Error")});const s=t.parentNode;s.parentNode.insertBefore(n,s)})};if(navigator&&navigator.clipboard)addCopyButtons(navigator.clipboard);else{const e=document.createElement("script");e.src="https://cdnjs.cloudflare.com/ajax/libs/clipboard-polyfill/2.7.0/clipboard-polyfill.promise.js",e.integrity="sha256-waClS2re9NUbXRsryKoof+F9qc1gjjIhc2eT7ZbIv94=",e.crossOrigin="anonymous",e.onload=()=>addCopyButtons(clipboard),document.body.appendChild(e)}</script></body></html>