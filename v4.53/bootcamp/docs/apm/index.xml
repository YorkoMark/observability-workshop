<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Splunk Observability Cloud Workshops â€“ Lab: Application Performance Monitoring</title><link>https://splunk.github.io/observability-workshop/v4.53/bootcamp/docs/apm/</link><description>Recent content in Lab: Application Performance Monitoring on Splunk Observability Cloud Workshops</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://splunk.github.io/observability-workshop/v4.53/bootcamp/docs/apm/index.xml" rel="self" type="application/rss+xml"/><item><title>Bootcamp: Microservices Auto-instrumentation</title><link>https://splunk.github.io/observability-workshop/v4.53/bootcamp/docs/apm/autoi/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v4.53/bootcamp/docs/apm/autoi/</guid><description>
&lt;p>The development team has broken up the monolithic service into microservices baesd on the &lt;code>docker-compose&lt;/code> setup. Switch to the provided milestone &lt;code>10microservices&lt;/code> with the instructions from &amp;ldquo;Getting Started&amp;rdquo;.&lt;/p>
&lt;p>Test the service with:&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-0" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-00-00-tab" data-toggle="tab" href="#tabs-00-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-00-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-0-content">
&lt;div class="tab-pane fade show active"
id="tabs-00-00" role="tabpanel" aria-labelled-by="tabs-00-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>curl -X POST http://127.0.0.1:8000/api -F &lt;span style="color:#033">text&lt;/span>&lt;span style="color:#555">=&lt;/span>@hamlet.txt&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Add auto-instrumentation to the &lt;code>public_api&lt;/code> microservice using the &lt;a href="https://github.com/signalfx/splunk-otel-python" target="_blank">Splunk distribution of OpenTelemetry Python&lt;/a>
. Review the &lt;a href="https://docs.splunk.com/Observability/gdi/get-data-in/application/python/get-started.html#nav-Instrument-a-Python-application" target="_blank">documentation&lt;/a>
and the &lt;a href="https://docs.splunk.com/Observability/gdi/get-data-in/application/python/get-started.html#nav-Instrument-a-Python-application" target="_blank">getting Started&lt;/a>
steps and apply it to &lt;code>Dockerfile&lt;/code>.&lt;/p>
&lt;p>Take into account the &lt;a href="https://github.com/signalfx/splunk-otel-python/blob/main/docs/advanced-config.md#trace-exporters" target="_blank">trace exporter&lt;/a>
settings and add the required environment variables to the &lt;code>.env&lt;/code> file for &lt;code>docker-compose&lt;/code>. Use the configuration to send traces directly to Splunk Observability Cloud.&lt;/p>
&lt;p>The milestone for this task is &lt;code>10microservices-autoi&lt;/code>. It has auto-instrumentation applied for &lt;em>all&lt;/em> microservices.&lt;/p></description></item><item><title>Bootcamp: Instrumentation in Kubernetes</title><link>https://splunk.github.io/observability-workshop/v4.53/bootcamp/docs/apm/k8s/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v4.53/bootcamp/docs/apm/k8s/</guid><description>
&lt;p>TODO Note on .env being overwritten&lt;/p>
&lt;p>TODO change name of environment from YOURENV to something else.&lt;/p>
&lt;p>The development team has started using Kubernetes for container orchestration. Switch to the provided milestone &lt;code>12microservices-k8s&lt;/code> with the instructions from &amp;ldquo;Getting Started&amp;rdquo;.&lt;/p>
&lt;p>The Kubernetes manifests are located in the &lt;code>k8s&lt;/code> folder. Add auto-instrumentation to the &lt;code>public_api&lt;/code> microservice &lt;code>deployment&lt;/code> by configuring the [Splunk distribution of OpenTelemetry Python][splunk-otel-python]. The &lt;code>Dockerfile&lt;/code> has already been prepared.&lt;/p>
&lt;p>Install the OpenTelemetry Collector to the environment using &lt;a href="https://github.com/signalfx/splunk-otel-collector-chart" target="_blank">Splunk&amp;amp;rsquo;s helm chart&lt;/a>
and use the provided &lt;code>values.yaml&lt;/code>:&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-0" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-00-00-tab" data-toggle="tab" href="#tabs-00-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-00-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-0-content">
&lt;div class="tab-pane fade show active"
id="tabs-00-00" role="tabpanel" aria-labelled-by="tabs-00-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>helm repo add splunk-otel-collector-chart https://signalfx.github.io/splunk-otel-collector-chart
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>helm install my-splunk-otel-collector --set&lt;span style="color:#555">=&lt;/span>&lt;span style="color:#c30">&amp;#34;splunkObservability.realm=&lt;/span>&lt;span style="color:#a00">${&lt;/span>&lt;span style="color:#033">SPLUNK_REALM&lt;/span>&lt;span style="color:#a00">}&lt;/span>&lt;span style="color:#c30">,splunkObservability.accessToken=&lt;/span>&lt;span style="color:#a00">${&lt;/span>&lt;span style="color:#033">SPLUNK_ACCESS_TOKEN&lt;/span>&lt;span style="color:#a00">}&lt;/span>&lt;span style="color:#c30">,clusterName=&lt;/span>&lt;span style="color:#a00">${&lt;/span>&lt;span style="color:#033">CLUSTER_NAME&lt;/span>&lt;span style="color:#a00">}&lt;/span>&lt;span style="color:#c30">&amp;#34;&lt;/span> splunk-otel-collector-chart/splunk-otel-collector -f values.yaml&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Rebuild the container images for the private registry:&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-1" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-01-00-tab" data-toggle="tab" href="#tabs-01-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-01-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-1-content">
&lt;div class="tab-pane fade show active"
id="tabs-01-00" role="tabpanel" aria-labelled-by="tabs-01-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker-compose build&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Push the images to the private registry:&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-2" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-02-00-tab" data-toggle="tab" href="#tabs-02-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-02-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-2-content">
&lt;div class="tab-pane fade show active"
id="tabs-02-00" role="tabpanel" aria-labelled-by="tabs-02-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker-compose push&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Deploy to the cluster with&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-3" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-03-00-tab" data-toggle="tab" href="#tabs-03-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-03-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-3-content">
&lt;div class="tab-pane fade show active"
id="tabs-03-00" role="tabpanel" aria-labelled-by="tabs-03-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kubectl apply -f k8s&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Test the service with&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-4" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-04-00-tab" data-toggle="tab" href="#tabs-04-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-04-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-4-content">
&lt;div class="tab-pane fade show active"
id="tabs-04-00" role="tabpanel" aria-labelled-by="tabs-04-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#033">ENDPOINT&lt;/span>&lt;span style="color:#555">=&lt;/span>&lt;span style="color:#069;font-weight:bold">$(&lt;/span>kubectl get service/public-api -o &lt;span style="color:#033">jsonpath&lt;/span>&lt;span style="color:#555">=&lt;/span>&lt;span style="color:#c30">&amp;#39;{.spec.clusterIP}&amp;#39;&lt;/span>&lt;span style="color:#069;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl http://&lt;span style="color:#033">$ENDPOINT&lt;/span>:8000/api -F &lt;span style="color:#033">text&lt;/span>&lt;span style="color:#555">=&lt;/span>@hamlet.txt&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>The milestone for this task is &lt;code>12microservices-k8s-autoi&lt;/code>. It has auto-instrumentation applied for &lt;em>all&lt;/em> microservices.&lt;/p></description></item><item><title>Bootcamp: Using OpenTelementry in Instrumentation</title><link>https://splunk.github.io/observability-workshop/v4.53/bootcamp/docs/apm/api/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://splunk.github.io/observability-workshop/v4.53/bootcamp/docs/apm/api/</guid><description>
&lt;p>The business teams want to add the service version, the customer profile that is defined by a color and the name of the analyzed file.&lt;/p>
&lt;p>Switch to the provided milestone &lt;code>12microservices-k8s-autoi&lt;/code> with the instructions from &amp;ldquo;Getting Started&amp;rdquo;.&lt;/p>
&lt;p>Implement the requested changes to the &lt;code>public-api&lt;/code> microservice.&lt;/p>
&lt;p>The Kubernetes manifests are located in the &lt;code>k8s&lt;/code> folder. Add the service version by &lt;a href="https://github.com/signalfx/splunk-otel-python/blob/main/docs/advanced-config.md#trace-configuration" target="_blank">configuring the OpenTelemetry resource attributes&lt;/a>
.&lt;/p>
&lt;p>The customer profile and the file name vary by request. Create attributes and assign them to the current span with the &lt;a href="https://opentelemetry-python.readthedocs.io/en/stable/faq-and-cookbook.html" target="_blank">OpenTelemetry Python API&lt;/a>
.&lt;/p>
&lt;p>You can use a random function to generate the customer profile (e.g. red, blue, green) with this snippet:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-python" data-lang="python">&lt;span style="display:flex;">&lt;span>color &lt;span style="color:#555">=&lt;/span> random&lt;span style="color:#555">.&lt;/span>choice([&lt;span style="color:#c30">&amp;#39;red&amp;#39;&lt;/span>, &lt;span style="color:#c30">&amp;#39;blue&amp;#39;&lt;/span>, &lt;span style="color:#c30">&amp;#39;green&amp;#39;&lt;/span>])
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Note 1: Do not use a temporary variable to retrieve the current span. Use the &lt;code>trace&lt;/code> directly.&lt;/p>
&lt;p>Note 2: Make sure to import modules.&lt;/p>
&lt;p>Rebuild the container images for the private registry:&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-0" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-00-00-tab" data-toggle="tab" href="#tabs-00-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-00-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-0-content">
&lt;div class="tab-pane fade show active"
id="tabs-00-00" role="tabpanel" aria-labelled-by="tabs-00-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker-compose build&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Push the images to the private registry:&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-1" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-01-00-tab" data-toggle="tab" href="#tabs-01-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-01-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-1-content">
&lt;div class="tab-pane fade show active"
id="tabs-01-00" role="tabpanel" aria-labelled-by="tabs-01-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>docker-compose push&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Delete the &lt;code>public-api&lt;/code> deployment:&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-2" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-02-00-tab" data-toggle="tab" href="#tabs-02-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-02-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-2-content">
&lt;div class="tab-pane fade show active"
id="tabs-02-00" role="tabpanel" aria-labelled-by="tabs-02-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kubectl delete deploy public-api&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Redeploy to the cluster with&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-3" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-03-00-tab" data-toggle="tab" href="#tabs-03-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-03-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-3-content">
&lt;div class="tab-pane fade show active"
id="tabs-03-00" role="tabpanel" aria-labelled-by="tabs-03-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>kubectl apply -f k8s&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Test the service with&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-4" role="tablist">
&lt;li class="nav-item">
&lt;a class="nav-link active persistLang-bash"
id="tabs-04-00-tab" data-toggle="tab" href="#tabs-04-00" role="tab"
onclick="persistLang(&amp;#34;bash&amp;#34;);"aria-controls="tabs-04-00" aria-selected="false">
Shell Command
&lt;/a>
&lt;/li>
&lt;/ul>
&lt;div class="tab-content" id="tabs-4-content">
&lt;div class="tab-pane fade show active"
id="tabs-04-00" role="tabpanel" aria-labelled-by="tabs-04-00-tab">
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f0f3f3;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#033">ENDPOINT&lt;/span>&lt;span style="color:#555">=&lt;/span>&lt;span style="color:#069;font-weight:bold">$(&lt;/span>kubectl get service/public-api -o &lt;span style="color:#033">jsonpath&lt;/span>&lt;span style="color:#555">=&lt;/span>&lt;span style="color:#c30">&amp;#39;{.spec.clusterIP}&amp;#39;&lt;/span>&lt;span style="color:#069;font-weight:bold">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>curl http://&lt;span style="color:#033">$ENDPOINT&lt;/span>:8000/api -F &lt;span style="color:#033">text&lt;/span>&lt;span style="color:#555">=&lt;/span>@hamlet.txt&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Verify in Splunk APM that traces contain the desired informations: TODO screenshot&lt;/p>
&lt;p>[Create a new indexed span tag][index-span-tag] so that the business team is able to breakdown performance per customer profile.&lt;/p>
&lt;p>The milestone for this task is &lt;code>13custom-instr&lt;/code>. It adds the described custom instrumentation.&lt;/p></description></item></channel></rss>