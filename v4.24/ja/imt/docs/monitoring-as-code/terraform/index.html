<!doctype html><html lang=ja class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.92.2">
<meta name=robots content="index, follow">
<link rel="shortcut icon" href=/observability-workshop/v4.24/favicons/favicon.ico>
<link rel=apple-touch-icon href=/observability-workshop/v4.24/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/observability-workshop/v4.24/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/observability-workshop/v4.24/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/observability-workshop/v4.24/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/observability-workshop/v4.24/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/observability-workshop/v4.24/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/observability-workshop/v4.24/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/observability-workshop/v4.24/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/observability-workshop/v4.24/favicons/android-192x192.png sizes=192x192>
<title>Monitoring as Code | Splunk Observability Cloud Workshops</title>
<meta name=description content="
Terraform1 を使用して Observability Cloud のダッシュボードとディテクターを管理します。
Terraform のSplunk Provider2 を初期化します
Terraformを実行して、Splunk Terraform Provider を使用してコードからディ …">
<meta property="og:title" content="Monitoring as Code">
<meta property="og:description" content="Terraform1 を使用して Observability Cloud のダッシュボードとディテクターを管理します。 Terraform のSplunk Provider2 を初期化します Terraformを実行して、Splunk Terraform Provider を">
<meta property="og:type" content="article">
<meta property="og:url" content="https://signalfx.github.io/observability-workshop/v4.24/ja/imt/docs/monitoring-as-code/terraform/"><meta property="article:section" content="imt">
<meta property="article:modified_time" content="2022-04-12T19:16:00+09:00"><meta property="og:site_name" content="Splunk Observability Cloud Workshops">
<meta itemprop=name content="Monitoring as Code">
<meta itemprop=description content="Terraform1 を使用して Observability Cloud のダッシュボードとディテクターを管理します。 Terraform のSplunk Provider2 を初期化します Terraformを実行して、Splunk Terraform Provider を">
<meta itemprop=dateModified content="2022-04-12T19:16:00+09:00">
<meta itemprop=wordCount content="2407">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="Monitoring as Code">
<meta name=twitter:description content="Terraform1 を使用して Observability Cloud のダッシュボードとディテクターを管理します。 Terraform のSplunk Provider2 を初期化します Terraformを実行して、Splunk Terraform Provider を">
<link rel=preload href=/observability-workshop/v4.24/scss/main.min.39785c4da9cb0cfe16de8f72aadcf06fb29187963dcb8220bb9935bd52331915.css as=style>
<link href=/observability-workshop/v4.24/scss/main.min.39785c4da9cb0cfe16de8f72aadcf06fb29187963dcb8220bb9935bd52331915.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
</head>
<body class=td-page>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" id=navbar1>
<a class=navbar-brand href=/observability-workshop/v4.24/ja/>
<span class=navbar-logo><img class=navbar-logo src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAC8AAAAvCAIAAAD8RQT7AAACwklEQVRYw+2YW2jTYBTHu4l4F1ERVMQL+qKgMBUU9EEfRAURUUFfBEUEBRGfdC+CrVt3cdbNSZ1zXqar024yp9MJKzh3FScyO+q8MDW3pvc2TZqkudSvtD4J66fkWyL0kNeQH8mX8/+dY8JMZuNcpjzNX9JQK64ZiEZlk9zDEe/aOmPQ8FIKlJpKtH+mNzUYg+Z38a7vvu2NRqHJlDhABPY0G4UmU8lhOnioFSu0GIImU9KXUOhYOz75kiFoMiVjsfDpl/i0UrQ0oePPkp5ACq5kHxs978JnlaHsxQVm/24H3zUGyaRE+Jj5DTGvEm0yeNfVsfeGVVGGYQJtk6kaIBfZ0OYUufBKrKRHCSWgmAQ5fmOIWl6DNjXx6dbwqRfgh4L6eJLC3v/oXW1HnOGFlsDeR0L3TygmEC+tn+j19ciNgt5Qzznc4B3AUPGd33xb7yL3G3LJVaaiX4kKMExCD+bf2YTctvCZZZEzndJYBIZJfE8F9jtBE0HsfpMswQNOoR+HYWIbPkyQiQIr4pyelKyOQ5No8UyoF1PLahjboMqIhqABl3/HA6EX05kGyEboSBuQIZ2/FDGnInKuSyaZnKcYLU32lMTF3P05ITHVb8nFNiQ09MZbXPPI+H9QliMuMuV9xIIqBN2vwAy8HTKw0gJ0sZuYW6l9MuBTS8MnnkujQSgOPxctdhGzy7VPTWL+5eiF1+ABUJJKMpGzr4CHaG8U1KrauH0IHEAot/kRDZ/swKeUaG9bvi13Em2jKUWF4gDDzdGn/zbcmHJE4MEWcZCAFPWk2xc8/ATcpbGl4zOsYFCC1IOsIex7/KchaEMj0ywkh9CH+3c59J8104uLbY36T758x1d68229twIZ+y+6qffGRFa5Jrd3jR3Td5ukJhVgr9TKWp03benp9fo7cmm1/lvImLUXDN757XWe5v+g+QU6sNkgKUPrgwAAAABJRU5ErkJggg=="></span><span class=font-weight-bold>Splunk Observability Cloud Workshops</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
</ul>
</div>
</nav>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" id=navbar2>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/observability-workshop/v4.24/ja/imt/><span class=active>Splunk IMT</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/observability-workshop/v4.24/ja/apm/><span>Splunk APM</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/observability-workshop/v4.24/ja/synthetics/><span>Splunk Synthetics</span></a>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
More Workshops
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/latest/pet-clinic/>Pet Clinic Java Workshop</a>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/latest/bootcamp/>O11y Bootcamp</a>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/latest/resources/>Resources</a>
</div>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
Releases
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/latest/>latest</a>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/v4.23>v4.23</a>
<a class=dropdown-item href=https://signalfx.github.io/observability-workshop/v4.24>v4.24</a>
</div>
</li>
<li class="nav-item dropdown mr-4 d-none d-lg-block">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
日本語
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/observability-workshop/v4.24/imt/docs/monitoring-as-code/terraform/>English</a>
</div>
</li>
</ul>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
<div id=td-sidebar-menu class=td-sidebar__inner>
<form class="td-sidebar__search d-flex align-items-center">
<input type=search class="form-control td-search-input" placeholder="&#xf002; サイトを検索..." aria-label=サイトを検索... autocomplete=off data-offline-search-index-json-src=/observability-workshop/v4.24/offline-search-index.e5e320770bfcfb68e196a8a3da1e329e.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation">
</button>
</form>
<nav class="collapse td-sidebar-nav" id=td-section-nav>
<div class="nav-item dropdown d-block d-lg-none">
<a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>
日本語
</a>
<div class=dropdown-menu aria-labelledby=navbarDropdownMenuLink>
<a class=dropdown-item href=/observability-workshop/v4.24/imt/docs/monitoring-as-code/terraform/>English</a>
</div>
</div>
<ul class="td-sidebar-nav__section pr-md-3 ul-0">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-observability-workshopv424jaimt-li>
<a href=/observability-workshop/v4.24/ja/imt/ title=はじめに class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-observability-workshopv424jaimt><span>Splunk IMT</span></a>
<ul class=ul-1>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-observability-workshopv424jaimtdocs-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv424jaimtdocs><span>セットアップと演習</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsinitial-setup-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/initial-setup/ title=ワークショップ環境へのアクセス class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsinitial-setup><span>AWS/EC2 インスタンスにアクセスする</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv424jaimtdocsgdi-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/gdi/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv424jaimtdocsgdi><span>データを取り込む</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsgdik3s-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/gdi/k3s/ title="Kubernetes環境にOpenTelemetry Collectorをデプロイする" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsgdik3s><span>OTel Collectorをデプロイする</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsgdinginx-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/gdi/nginx/ title="K3s に NGINX をデプロイする" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsgdinginx><span>NGINX をデプロイして監視する</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv424jaimtdocsdashboards-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/dashboards/ title=ダッシュボードを利用する class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv424jaimtdocsdashboards><span>ダッシュボード</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdashboardsintro-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/dashboards/intro/ title=ダッシュボード、チャート、メトリクスを使う class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdashboardsintro><span>はじめに</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdashboardsediting-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/dashboards/editing/ title=チャートを編集する class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdashboardsediting><span>チャートの編集</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdashboardssavingcharts-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/dashboards/savingcharts/ title=チャートを保存する class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdashboardssavingcharts><span>チャートの保存</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdashboardsfiltering-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/dashboards/filtering/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdashboardsfiltering><span>フィルタと数式の使い方</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdashboardssignalflow-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/dashboards/signalflow/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdashboardssignalflow><span>SignalFlow</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdashboardsadding-charts-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/dashboards/adding-charts/ title=ダッシュボードにチャートを追加する class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdashboardsadding-charts><span>さらにチャートを追加</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdashboardsdashboarding-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/dashboards/dashboarding/ title=ノートの追加とダッシュボードのレイアウト class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdashboardsdashboarding><span>ノートとレイアウト</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv424jaimtdocsdetectors-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/detectors/ title=ディテクターを利用する class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv424jaimtdocsdetectors><span>ディテクター</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdetectorscreating-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/detectors/creating/ title=ディテクターを利用する class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdetectorscreating><span>ディテクターの作成</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsdetectorsmuting-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/detectors/muting/ title=ミューティングルールを利用する class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsdetectorsmuting><span>ミューティングルールの作成</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-observability-workshopv424jaimtdocsmonitoring-as-code-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/monitoring-as-code/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv424jaimtdocsmonitoring-as-code><span>Monitoring as Code</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-observability-workshopv424jaimtdocsmonitoring-as-codeterraform-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/monitoring-as-code/terraform/ title="Monitoring as Code" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsmonitoring-as-codeterraform><span class=td-sidebar-nav-active-item>Plan, Apply, Destroy</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-observability-workshopv424jaimtdocsservicebureau-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/servicebureau/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-observability-workshopv424jaimtdocsservicebureau><span>管理機能</span></a>
<ul class="ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsservicebureaubilling-and-usage-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/servicebureau/billing-and-usage/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsservicebureaubilling-and-usage><span>サブスクリプション使用量</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsservicebureauteams-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/servicebureau/teams/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsservicebureauteams><span>チーム</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-observability-workshopv424jaimtdocsservicebureautokens-li>
<a href=/observability-workshop/v4.24/ja/imt/docs/servicebureau/tokens/ title=使用量を管理する class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-observability-workshopv424jaimtdocsservicebureautokens><span>使用量の管理</span></a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
<aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
</div>
<div class=td-toc><nav id=TableOfContents>
<ul>
<li><a href=#1-初期設定>1. 初期設定</a></li>
<li><a href=#2-プランの作成>2. プランの作成</a></li>
<li><a href=#3-プランの適用>3. プランの適用</a></li>
<li><a href=#3-苦労して作ったもの全てを壊す>3. 苦労して作ったもの全てを壊す</a></li>
</ul>
</nav></div>
<div class="taxonomy taxonomy-terms-cloud taxo-tags">
<h5 class=taxonomy-title>Tag Cloud</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=https://signalfx.github.io/observability-workshop/v4.24/ja/tags/k3s/ data-taxonomy-term=k3s><span class=taxonomy-label>k3s</span><span class=taxonomy-count>1</span></a></li>
<li><a class=taxonomy-term href=https://signalfx.github.io/observability-workshop/v4.24/ja/tags/ngnix/ data-taxonomy-term=ngnix><span class=taxonomy-label>NGNIX</span><span class=taxonomy-count>1</span></a></li>
</ul>
</div>
<div class="taxonomy taxonomy-terms-cloud taxo-categories">
<h5 class=taxonomy-title>Categories</h5>
<ul class=taxonomy-terms>
<li><a class=taxonomy-term href=https://signalfx.github.io/observability-workshop/v4.24/ja/categories/imt/ data-taxonomy-term=imt><span class=taxonomy-label>IMT</span><span class=taxonomy-count>2</span></a></li>
</ul>
</div>
</aside>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<nav aria-label=breadcrumb class=td-breadcrumbs>
<ol class=breadcrumb>
<li class=breadcrumb-item>
<a href=https://signalfx.github.io/observability-workshop/v4.24/ja/imt/>Splunk IMT</a>
</li>
<li class=breadcrumb-item>
<a href=https://signalfx.github.io/observability-workshop/v4.24/ja/imt/docs/>セットアップと演習</a>
</li>
<li class=breadcrumb-item>
<a href=https://signalfx.github.io/observability-workshop/v4.24/ja/imt/docs/monitoring-as-code/>Monitoring as Code</a>
</li>
<li class="breadcrumb-item active" aria-current=page>
<a href=https://signalfx.github.io/observability-workshop/v4.24/ja/imt/docs/monitoring-as-code/terraform/>Plan, Apply, Destroy</a>
</li>
</ol>
</nav>
<div class=td-content>
<h1>Monitoring as Code</h1>
<header class=article-meta>
<p class=reading-time><i class="fa fa-clock" aria-hidden=true></i>&nbsp; 5 minute read &nbsp;</p>
</header>
<ul>
<li>Terraform<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> を使用して Observability Cloud のダッシュボードとディテクターを管理します。</li>
<li>Terraform のSplunk Provider<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> を初期化します</li>
<li>Terraformを実行して、Splunk Terraform Provider を使用してコードからディテクターとダッシュボードを作成します。</li>
<li>Terraformでディテクターやダッシュボードを削除する方法を確認します。</li>
</ul>
<hr>
<h2 id=1-初期設定>1. 初期設定</h2>
<p>Monitoring as Codeは、infrastructure as Codeと同じアプローチを採用しています。アプリケーション、サーバー、その他のインフラコンポーネントと同じようにモニタリングを管理できます。</p>
<p>Monitoring as Codeでは、可視化したり、何を監視するか定義したり、いつアラートを出すかなどを管理します。つまり、監視設定、プロセス、ルールをバージョン管理、共有、再利用することができます。</p>
<p>Splunk Terraform Providerの完全なドキュメントは<a href=https://registry.terraform.io/providers/splunk-terraform/signalfx/latest/docs target=_blank>こちら</a>
にあります。</p>
<p>AWS/EC2 インスタンスにログインして、<code>signalfx-jumpstart</code> ディレクトリに移動します</p>
<ul class="nav nav-tabs" id=tabs-0 role=tablist><li class=nav-item>
<a class="nav-link active tab-Change-directory" id=tabs-0-0-tab data-toggle=tab href=#tabs-0-0 role=tab onclick='handleClick("Change-directory")' aria-controls=tabs-0-0 aria-selected=true>
Change directory
</a>
</li></ul>
<div class=tab-content id=tabs-0-content><div class="tab-pane fade show active" id=tabs-0-0 role=tabpanel aria-labelled-by=tabs-0-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#204a87>cd</span> ~/signalfx-jumpstart</code></pre></div></div>
</div>
<p>必要な環境変数は、<a href=../../gdi/k3s/#2-helm%E3%81%AB%E3%82%88%E3%82%8B%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB>Helmによるインストール</a>
ですでに設定されているはずです。そうでない場合は、以下の Terraform のステップで使用するために、以下の環境変数を作成してください。</p>
<ul class="nav nav-tabs" id=tabs-1 role=tablist><li class=nav-item>
<a class="nav-link active tab-Environment-Variables" id=tabs-1-0-tab data-toggle=tab href=#tabs-1-0 role=tab onclick='handleClick("Environment-Variables")' aria-controls=tabs-1-0 aria-selected=true>
Environment Variables
</a>
</li></ul>
<div class=tab-content id=tabs-1-content><div class="tab-pane fade show active" id=tabs-1-0 role=tabpanel aria-labelled-by=tabs-1-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#204a87>export</span> <span style=color:#000>ACCESS_TOKEN</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;replace_with_O11y-Workshop-ACCESS_token&gt;
<span style=color:#204a87>export</span> <span style=color:#000>REALM</span><span style=color:#ce5c00;font-weight:700>=</span>&lt;replace_with_splunk_realm&gt;</code></pre></div></div>
</div>
<p>Terraform を初期化し、Splunk Terraform Provider を最新版にアップグレードします。</p>
<div class="alert alert-primary" role=alert>
<p class=alert-heading>Note: SignalFx Terraform Provider のアップグレード</p>
<div class=alert-body>
<p>Splunk Terraform Provider の新バージョンがリリースされるたびに、以下のコマンドを実行する必要があります。リリース情報は <a href=https://github.com/splunk-terraform/terraform-provider-signalfx/releases target=_blank>GitHub</a>
<p>で確認できます。</p></p>
</div>
</div>
<ul class="nav nav-tabs" id=tabs-3 role=tablist><li class=nav-item>
<a class="nav-link active tab-Initialise-Terraform" id=tabs-3-0-tab data-toggle=tab href=#tabs-3-0 role=tab onclick='handleClick("Initialise-Terraform")' aria-controls=tabs-3-0 aria-selected=true>
Initialise Terraform
</a>
</li><li class=nav-item>
<a class="nav-link tab-Initialise-Output" id=tabs-3-1-tab data-toggle=tab href=#tabs-3-1 role=tab onclick='handleClick("Initialise-Output")' aria-controls=tabs-3-1 aria-selected=false>
Initialise Output
</a>
</li></ul>
<div class=tab-content id=tabs-3-content><div class="tab-pane fade show active" id=tabs-3-0 role=tabpanel aria-labelled-by=tabs-3-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>terraform init -upgrade</code></pre></div></div>
<div class="tab-pane fade" id=tabs-3-1 role=tabpanel aria-labelled-by=tabs-3-1-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>Upgrading modules...
- aws in modules/aws
- azure in modules/azure
- docker in modules/docker
- gcp in modules/gcp
- host in modules/host
- kafka in modules/kafka
- kubernetes in modules/kubernetes
- parent_child_dashboard in modules/dashboards/parent
- pivotal in modules/pivotal
- usage_dashboard in modules/dashboards/usage

Initializing the backend...

Initializing provider plugins...
- Finding latest version of splunk-terraform/signalfx...
- Installing splunk-terraform/signalfx v6.7.10...
- Installed splunk-terraform/signalfx v6.7.10 (signed by a HashiCorp partner, key ID 8B5755E223754FC9)

Partner and community providers are signed by their developers.
If you&#39;d like to know more about provider signing, you can read about it here:
https://www.terraform.io/docs/cli/plugins/signing.html

Terraform has created a lock file .terraform.lock.hcl to record the provider
selections it made above. Include this file in your version control repository
so that Terraform can guarantee to make the same selections by default when
you run &#34;terraform init&#34; in the future.

Terraform has been successfully initialized!

You may now begin working with Terraform. Try running &#34;terraform plan&#34; to see
any changes that are required for your infrastructure. All Terraform commands
should now work.

If you ever set or change modules or backend configuration for Terraform,
rerun this command to reinitialize your working directory. If you forget, other
commands will detect it and remind you to do so if necessary.</code></pre></div></div>
</div>
<h2 id=2-プランの作成>2. プランの作成</h2>
<p><code>terraform plan</code> コマンドで、実行計画を作成します。デフォルトでは、プランの作成は以下のように構成されています。</p>
<ul>
<li>既に存在するリモートオブジェクトの現在の状態を読み込み、Terraform の状態が最新であることを確認します</li>
<li>現在の設定を以前の状態と比較し、相違点を抽出します</li>
<li>適用された場合にリモートオブジェクトと設定とを一致させるための、一連の変更アクションを提案します</li>
</ul>
<p>plan コマンドだけでは、提案された変更を実際に実行はされなません。変更を適用する前に、以下のコマンドを実行して、提案された変更が期待したものと一致するかどうかを確認しましょう。</p>
<ul class="nav nav-tabs" id=tabs-4 role=tablist><li class=nav-item>
<a class="nav-link active tab-Execution-Plan" id=tabs-4-0-tab data-toggle=tab href=#tabs-4-0 role=tab onclick='handleClick("Execution-Plan")' aria-controls=tabs-4-0 aria-selected=true>
Execution Plan
</a>
</li><li class=nav-item>
<a class="nav-link tab-Execution-Plan-Output" id=tabs-4-1-tab data-toggle=tab href=#tabs-4-1 role=tab onclick='handleClick("Execution-Plan-Output")' aria-controls=tabs-4-1 aria-selected=false>
Execution Plan Output
</a>
</li></ul>
<div class=tab-content id=tabs-4-content><div class="tab-pane fade show active" id=tabs-4-0 role=tabpanel aria-labelled-by=tabs-4-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>terraform plan -var<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;access_token=</span><span style=color:#000>$ACCESS_TOKEN</span><span style=color:#4e9a06>&#34;</span> -var<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;realm=</span><span style=color:#000>$REALM</span><span style=color:#4e9a06>&#34;</span> -var<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sfx_prefix=[</span><span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>]&#34;</span></code></pre></div></div>
<div class="tab-pane fade" id=tabs-4-1 role=tabpanel aria-labelled-by=tabs-4-1-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Plan: <span style=color:#0000cf;font-weight:700>92</span> to add, <span style=color:#0000cf;font-weight:700>0</span> to change, <span style=color:#0000cf;font-weight:700>0</span> to destroy.</code></pre></div></div>
</div>
<p>プランが正常に実行されれば、そのまま apply することができます。</p>
<hr>
<h2 id=3-プランの適用>3. プランの適用</h2>
<p><code>terraform apply</code> コマンドは、上記の Terraform プランで提案されたアクションを実行します。</p>
<p>この場合、新しい実行プランが自動的に作成され（<code>terraform plan</code>を実行したときと同様です）、指示されたアクションを実行する前にAccess Token、Realm（プレフィックスのデフォルトは<code>Splunk</code>）の提供とプランの承認を求められます。</p>
<p>このワークショップでは、プレフィックスがユニークである必要があります。以下の <code>terraform apply</code> を実行してください。</p>
<ul class="nav nav-tabs" id=tabs-5 role=tablist><li class=nav-item>
<a class="nav-link active tab-Apply-Plan" id=tabs-5-0-tab data-toggle=tab href=#tabs-5-0 role=tab onclick='handleClick("Apply-Plan")' aria-controls=tabs-5-0 aria-selected=true>
Apply Plan
</a>
</li><li class=nav-item>
<a class="nav-link tab-Apply-Plan-Output" id=tabs-5-1-tab data-toggle=tab href=#tabs-5-1 role=tab onclick='handleClick("Apply-Plan-Output")' aria-controls=tabs-5-1 aria-selected=false>
Apply Plan Output
</a>
</li></ul>
<div class=tab-content id=tabs-5-content><div class="tab-pane fade show active" id=tabs-5-0 role=tabpanel aria-labelled-by=tabs-5-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>terraform apply -var<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;access_token=</span><span style=color:#000>$ACCESS_TOKEN</span><span style=color:#4e9a06>&#34;</span> -var<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;realm=</span><span style=color:#000>$REALM</span><span style=color:#4e9a06>&#34;</span> -var<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;sfx_prefix=[</span><span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span><span style=color:#4e9a06>]&#34;</span></code></pre></div></div>
<div class="tab-pane fade" id=tabs-5-1 role=tabpanel aria-labelled-by=tabs-5-1-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Apply complete! Resources: <span style=color:#0000cf;font-weight:700>92</span> added, <span style=color:#0000cf;font-weight:700>0</span> changed, <span style=color:#0000cf;font-weight:700>0</span> destroyed.</code></pre></div></div>
</div>
<p>適用が完了したら、 <strong>Alerts → Detectors</strong> でディテクターが作成されたことを確認してください。ディテクターのプレフィックスには、インスタンスのホスト名が入ります。プレフィックスの値を確認するには以下を実行してください。</p>
<ul class="nav nav-tabs" id=tabs-6 role=tablist><li class=nav-item>
<a class="nav-link active tab-Echo-Hostname" id=tabs-6-0-tab data-toggle=tab href=#tabs-6-0 role=tab onclick='handleClick("Echo-Hostname")' aria-controls=tabs-6-0 aria-selected=true>
Echo Hostname
</a>
</li></ul>
<div class=tab-content id=tabs-6-content><div class="tab-pane fade show active" id=tabs-6-0 role=tabpanel aria-labelled-by=tabs-6-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#204a87>echo</span> <span style=color:#204a87;font-weight:700>$(</span>hostname<span style=color:#204a87;font-weight:700>)</span></code></pre></div></div>
</div>
<p>新しいディテクターのリストが表示され、上から出力されたプレフィックスを検索することができます。</p>
<p><img src=../../../images/detectors.png alt=Detectors></p>
<h2 id=3-苦労して作ったもの全てを壊す>3. 苦労して作ったもの全てを壊す</h2>
<p><code>terraform destroy</code> コマンドは、Terraform の設定で管理されているすべてのリモートオブジェクトを破壊する便利な方法です。</p>
<p>通常、本番環境では長期保存可能なオブジェクトを破棄することはありませんが、Terraformでは開発目的で一時的なインフラを管理するために使用されることがあり、その場合は作業が終わった後に <code>terraform destroy</code> を実行して、一時的なオブジェクトをすべてクリーンアップすることができます。</p>
<p>それでは、ここまでで適用したダッシュボードとディテクターを全て破壊しましょう！</p>
<ul class="nav nav-tabs" id=tabs-7 role=tablist><li class=nav-item>
<a class="nav-link active tab-Destroy" id=tabs-7-0-tab data-toggle=tab href=#tabs-7-0 role=tab onclick='handleClick("Destroy")' aria-controls=tabs-7-0 aria-selected=true>
Destroy
</a>
</li><li class=nav-item>
<a class="nav-link tab-Destroy-Output" id=tabs-7-1-tab data-toggle=tab href=#tabs-7-1 role=tab onclick='handleClick("Destroy-Output")' aria-controls=tabs-7-1 aria-selected=false>
Destroy Output
</a>
</li></ul>
<div class=tab-content id=tabs-7-content><div class="tab-pane fade show active" id=tabs-7-0 role=tabpanel aria-labelled-by=tabs-7-0-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>terraform destroy -var<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;access_token=</span><span style=color:#000>$ACCESS_TOKEN</span><span style=color:#4e9a06>&#34;</span> -var<span style=color:#ce5c00;font-weight:700>=</span><span style=color:#4e9a06>&#34;realm=</span><span style=color:#000>$REALM</span><span style=color:#4e9a06>&#34;</span></code></pre></div></div>
<div class="tab-pane fade" id=tabs-7-1 role=tabpanel aria-labelled-by=tabs-7-1-tab><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>Destroy complete! Resources: <span style=color:#0000cf;font-weight:700>92</span> destroyed.</code></pre></div></div>
</div>
<p><em><strong>Alerts → Detectors</strong></em> に移動して、すべてのディテクターが削除されたことを確認してください。</p>
<p><img src=../../../images/destroy.png alt=Destroyed></p>
<section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p>Terraform は、インフラを安全かつ効率的に構築、変更、バージョン管理するためのツールです。Terraform は、既存の一般的なサービスプロバイダーだけでなく、様々なカスタムソリューションも管理できます。</p>
<p>Terraform の設定ファイルには、単一のアプリケーションまたはデータセンター全体を実行するために必要なコンポーネントをに記述します。Terraform はそれを受けて、望ましい状態に到達するために何をするかを記述した実行プランを生成し、記述されたインフラを構築するために実行します。設定が変更されても、Terraform は何が変更されたかを判断し、差分の実行プランを作成して適用することができます。</p>
<p>Terraform が管理できるインフラには、計算機インスタンス、ストレージ、ネットワークなどのローレベルのコンポーネントや、DNSエントリ、SaaS機能などのハイレベルのコンポーネントが含まれます。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:2 role=doc-endnote>
<p>プロバイダーは、APIのインタラクションを理解し、リソースを公開する責務があります。一般的にプロバイダーは、IaaS（Alibaba Cloud、AWS、GCP、Microsoft Azure、OpenStackなど）、PaaS（Herokuなど）、またはSaaSサービス（Splunk、Terraform Cloud、DNSimple、Cloudflareなど）があります。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter>
<a class=text-white target=_blank rel=noopener href=https://twitter.com/splunk aria-label=Twitter>
<i class="fab fa-twitter"></i>
</a>
</li>
</ul>
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/signalfx/observability-workshop aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
<small class=text-white>&copy; 2022 Splunk Inc. All Rights Reserved</small>
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/observability-workshop/v4.24/js/tabpane-persist.js></script>
<script src=/observability-workshop/v4.24/js/main.min.8ab8f81ff7e1454d30024cd6f956d4d341c3a97e2a673f988065f2ee4e147922.js integrity="sha256-irj4H/fhRU0wAkzW+VbU00HDqX4qZz+YgGXy7k4UeSI=" crossorigin=anonymous></script>
<script>const svgCopy='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"><path fill-rule="evenodd" d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"></path><path fill-rule="evenodd" d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"></path></svg>',svgCheck='<svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true"><path fill-rule="evenodd" fill="rgb(63, 185, 80)" d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"></path></svg>',addCopyButtons=a=>{document.querySelectorAll("pre > code").forEach(c=>{const b=document.createElement("button");b.className="clipboard-button",b.type="button",b.innerHTML=svgCopy,b.addEventListener("click",()=>{a.writeText(c.innerText).then(()=>{b.blur(),b.innerHTML=svgCheck,setTimeout(()=>b.innerHTML=svgCopy,2e3)},a=>b.innerHTML="Error")});const d=c.parentNode;d.parentNode.insertBefore(b,d)})};if(navigator&&navigator.clipboard)addCopyButtons(navigator.clipboard);else{const a=document.createElement("script");a.src="https://cdnjs.cloudflare.com/ajax/libs/clipboard-polyfill/2.7.0/clipboard-polyfill.promise.js",a.integrity="sha256-waClS2re9NUbXRsryKoof+F9qc1gjjIhc2eT7ZbIv94=",a.crossOrigin="anonymous",a.onload=()=>addCopyButtons(clipboard),document.body.appendChild(a)}</script>
</body>
</html>